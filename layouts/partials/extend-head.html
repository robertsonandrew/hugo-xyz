<!-- eslint-disable -->
<!-- @format:off -->

{{/* Load Space Grotesk font from Google Fonts */}}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">

{{/* Inject CSS Variables for Logo Gradients & Backgrounds */}}
<style>
:root {
  --logo-gradient-angle: {{ .Params.logoGradientAngle | default 120 }}deg;
  --logo-gradient-speed: {{ .Params.logoAnimationSpeed | default "2s" }};
  {{- $stops := .Params.logoGradientStops | default (slice "#ffffff" "#ffffff" "#ffffff") -}}
  {{- $stopsStr := delimit $stops "," -}}
  --logo-gradient-stops: {{ $stopsStr }};
  {{- if .Params.backgroundImageURL -}}
  --bg-image: url('{{ .Params.backgroundImageURL }}');
  {{- else -}}
  --bg-image: none;
  {{- end -}}
  --bg-color-light: {{ .Params.defaultBackgroundColorLight | default "#CCCCCC" }};
  --bg-color-dark: {{ .Params.defaultBackgroundColorDark | default "#1f1f1fff" }};
  {{- with .Params.quoteBanner -}}
  {{- if .lightModeGradient -}}
  {{- $lightStops := delimit .lightModeGradient ", " -}}
  --quote-banner-light-gradient: linear-gradient(135deg, {{ $lightStops }});
  {{- end -}}
  {{- if .darkModeGradient -}}
  {{- $darkStops := delimit .darkModeGradient ", " -}}
  --quote-banner-dark-gradient: linear-gradient(135deg, {{ $darkStops }});
  {{- end -}}
  {{- end -}}
}
</style>

{{/* Early-load saved gradient from localStorage for FOUC prevention */}}
<script>
  (function () {
    try {
      var savedStops = localStorage.getItem('logoGradientStops');
      if (savedStops) {
        {{/* Apply saved gradient immediately to prevent flash */}}
        document.documentElement.style.setProperty('--logo-gradient-stops', savedStops);
      }
    } catch (e) {
      {{/* Silently fail if localStorage is unavailable */}}
    }
  })();
  {{/* JS intentionally runs synchronously to prevent FOUC */}}
</script>

{{- /* Bundle all custom CSS files together for performance */ -}}
{{ $customCSS := resources.Get "css/custom.css" }}
{{ $ssCSS := resources.Get "css/screensaver.css" }}
{{ $ssControlsCSS := resources.Get "css/screensaver-controls.css" }}
{{ $quoteBannerCSS := resources.Get "css/quote-banner.css" }}
{{ $switcherCSS := resources.Get "css/logo-gradient-switcher.css" }}

{{- /* Create a slice of all CSS resources that exist */ -}}
{{ $cssFiles := slice }}
{{ if $customCSS }}{{ $cssFiles = $cssFiles | append $customCSS }}{{ end }}
{{ if $ssCSS }}{{ $cssFiles = $cssFiles | append $ssCSS }}{{ end }}
{{ if $ssControlsCSS }}{{ $cssFiles = $cssFiles | append $ssControlsCSS }}{{ end }}
{{ if $quoteBannerCSS }}{{ $cssFiles = $cssFiles | append $quoteBannerCSS }}{{ end }}
{{ if $switcherCSS }}{{ $cssFiles = $cssFiles | append $switcherCSS }}{{ end }}

{{- /* Concatenate, minify, and fingerprint all CSS into one bundle */ -}}
{{ if gt (len $cssFiles) 0 }}
  {{ $bundledCSS := $cssFiles | resources.Concat "css/custom-bundle.css" | resources.Minify | resources.Fingerprint }}
  <link rel="stylesheet" href="{{ $bundledCSS.RelPermalink }}" integrity="{{ $bundledCSS.Data.Integrity }}">
{{ end }}



